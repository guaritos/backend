- id: "rules_v1"
  name: Detect Money Laundering
  source: transactions
  interval: 3600

  when:
    and:
      - type: count
        field: tx_count
        operator: ">"
        value: 50

      - type: sum
        field: value
        operator: ">"
        value: 1000000

      - and:
          - type: exists
            field: path
            operator: "true"
          - type: plain
            field: contract
            value: "tornado"
            operator: ">"

      - or:
          - type: contains
            field: contract
            value: "tornado"
          - type: contains
            field: contract
            value: "mixer"

  aggregate:
    - type: count
      field: tx_count
      operator: ">"
      value: 50

    - type: sum
      field: value
      operator: ">"
      value: 1000000

  then:
    - type: tag
      value: "Money Laundering"
    - type: notify
      message: "Potential money laundering detected."
    - type: mail
      to: ["compliance@example.com"]
      subject: "Alert: Money Laundering Detected"
